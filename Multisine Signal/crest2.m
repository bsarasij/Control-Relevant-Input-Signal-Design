function [cf,cferr]=crest2(X,N,Fe)% CREST2 Compute the crest factors (Kr').% Use cf  =crest2(X,N,Fe) with%		Input argument :%		-	X  : Matrix containing the Fourier coefficients of signals%         column by column%  - N  : Number of time samples to be used%		-	Fe : Set of the effective harmonic numbers%		Output argument :%		-	cf : Matrix containing two row vector with the lower and%         upper crest factor values% See also CREST1, CFMINIMAX, SCHROEDER.%%	P.A.N. Guillaume - version 1 / 17 November 1990%	Copyright (c) 1990 by dept. ELEC, V.U.B.%% Reference :  The calculation of the error on the crest factor% approximation is based on the inequality of Berstein.% See :  Approximation of Functions, G.G. Lorentz, p. 39.%if nargin<3   if nargin<2, x=four2tim(X); else x=four2tim(X,N); end			cf=lnorm(x,inf)./effval(X);else   if isempty(N), x=four2tim(X); else x=four2tim(X,N); end			cf=lnorm(x,inf)./effval(X,Fe);endif nargin<2, [N,colno]=size(x); end[rowno,colno]=size(X);if colno==1, dummy=X; else dummy=max(abs(X)')'; endFt=cumsum(ones(size(dummy)));Ft=Ft(dummy>max(dummy)*1e-6);clear dummyif nargin<3, Fe=Ft; endkmax=max(max(Ft))-1;if N>pi*kmax   cferr=cf/(1-pi*kmax/N);end